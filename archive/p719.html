<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>UFO CTF 2013 writeup – Web200</title><meta name=description content="talk about daily things"><meta name=keywords content><meta property="og:url" content="https://blog.tyage.net/archive/p719.html"><meta property="og:type" content="website"><meta property="og:title" content="UFO CTF 2013 writeup – Web200"><meta property="og:description" content="talk about daily things"><meta property="og:image" content="/icon/icon.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="UFO CTF 2013 writeup – Web200"><meta name=twitter:description content="talk about daily things"><meta property="twitter:domain" content="https://blog.tyage.net/archive/p719.html"><meta property="twitter:url" content="https://blog.tyage.net/archive/p719.html"><meta name=twitter:image content="/icon/icon.jpg"><link rel=canonical href=https://blog.tyage.net/archive/p719.html><link rel=stylesheet type=text/css href=https://blog.tyage.net/css/normalize.min.css media=print onload='this.media="all"'><link rel=stylesheet type=text/css href=https://blog.tyage.net/css/main.css><link disabled id=dark-theme rel=stylesheet href=https://blog.tyage.net/css/dark.css><script src=https://blog.tyage.net/js/svg-injector.min.js></script>
<script src=https://blog.tyage.net/js/feather-icons.min.js></script>
<script src=https://blog.tyage.net/js/main.js></script></head><body><script type=text/javascript>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://blog.tyage.net><img src=https://blog.tyage.net/icon/icon.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://blog.tyage.net>blog.tyage.net</a></div><div class=nav-links><div class=nav-link><a href=https://blog.tyage.net/post><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://blog.tyage.net/index.xml><span data-feather=rss></span></a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only></span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span id=hamburger-menu-toggle-screen-reader-target class=sr-only>menu</span>
<a><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://blog.tyage.net/post><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://blog.tyage.net/index.xml><span data-feather=rss></span></a></li><li class="nav-item dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only>theme</span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>UFO CTF 2013 writeup – Web200</h1><small role=doc-subtitle></small><p class=post-date>October 5, 2013</p><ul class=post-tags></ul></div><div class=post-content><p><pre>
Those aliens consider themselves as the most smart creatures in
the world. Pff. They shouldn't even have tried to defeat mankind
having such stupid stuff in their heads! As for you, why wouldn't
you hack them? They'll most likely surrender then. By the way, it
is known that they update some data every 10-20 seconds, but
unfortunately our equipment can't intercept the data itself.
 
http://superhosting.tasks.ufoctf.ru:8000/
</pre><p>自分のウェブページが作れ、バックアップと復元ができるシステムになっている。</p><p>バックアップしてみると、[username]_[md5(username)][md5(zipfile)].zipという名前でzipファイルがダウンロードでき、それをアップロードすることで復元ができるようになっている。<br>zipファイルの中身を解凍すると、.backupという名前で以下のようなファイルが入っている。</p><div class=wp_syntax style=position:relative><table><tr><td class=code><pre class=xml style=font-family:monospace><span style=color:#090><span style=color:#000;font-weight:700>&lt;?xml</span> <span style=color:#006>version</span>=<span style=color:red>&quot;1.0&quot;</span> <span style=color:#006>encoding</span>=<span style=color:red>&quot;utf-8&quot;</span><span style=color:#000;font-weight:700>?&gt;</span></span>
<span style=color:#090><span style=color:#000;font-weight:700>&lt;django-objects</span> <span style=color:#006>version</span>=<span style=color:red>&quot;1.0&quot;</span><span style=color:#000;font-weight:700>&gt;</span></span>
	<span style=color:#090><span style=color:#000;font-weight:700>&lt;object</span> <span style=color:#006>pk</span>=<span style=color:red>&quot;12349813568&quot;</span> <span style=color:#006>model</span>=<span style=color:red>&quot;hosting.pagesettings&quot;</span><span style=color:#000;font-weight:700>&gt;</span></span>
		<span style=color:#090><span style=color:#000;font-weight:700>&lt;field</span> <span style=color:#006>type</span>=<span style=color:red>&quot;CharField&quot;</span> <span style=color:#006>name</span>=<span style=color:red>&quot;owner_name&quot;</span><span style=color:#000;font-weight:700>&gt;</span></span>username<span style=color:#090><span style=color:#000;font-weight:700>&lt;/field<span style=color:#000;font-weight:700>&gt;</span></span></span>
		<span style=color:#090><span style=color:#000;font-weight:700>&lt;field</span> <span style=color:#006>type</span>=<span style=color:red>&quot;CharField&quot;</span> <span style=color:#006>name</span>=<span style=color:red>&quot;owner_email&quot;</span><span style=color:#000;font-weight:700>&gt;</span></span>test@localhost<span style=color:#090><span style=color:#000;font-weight:700>&lt;/field<span style=color:#000;font-weight:700>&gt;</span></span></span>
		<span style=color:#090><span style=color:#000;font-weight:700>&lt;field</span> <span style=color:#006>type</span>=<span style=color:red>&quot;CharField&quot;</span> <span style=color:#006>name</span>=<span style=color:red>&quot;page_title&quot;</span><span style=color:#000;font-weight:700>&gt;</span></span>My homepage<span style=color:#090><span style=color:#000;font-weight:700>&lt;/field<span style=color:#000;font-weight:700>&gt;</span></span></span>
		<span style=color:#090><span style=color:#000;font-weight:700>&lt;field</span> <span style=color:#006>type</span>=<span style=color:red>&quot;TextField&quot;</span> <span style=color:#006>name</span>=<span style=color:red>&quot;page_content&quot;</span><span style=color:#000;font-weight:700>&gt;</span></span>Hello everyone! This is my new homepage.<span style=color:#090><span style=color:#000;font-weight:700>&lt;/field<span style=color:#000;font-weight:700>&gt;</span></span></span>
		<span style=color:#090><span style=color:#000;font-weight:700>&lt;field</span> <span style=color:#006>type</span>=<span style=color:red>&quot;CharField&quot;</span> <span style=color:#006>name</span>=<span style=color:red>&quot;page_footer&quot;</span><span style=color:#000;font-weight:700>&gt;</span></span>Made with love and care<span style=color:#090><span style=color:#000;font-weight:700>&lt;/field<span style=color:#000;font-weight:700>&gt;</span></span></span>
		<span style=color:#090><span style=color:#000;font-weight:700>&lt;field</span> <span style=color:#006>type</span>=<span style=color:red>&quot;BooleanField&quot;</span> <span style=color:#006>name</span>=<span style=color:red>&quot;page_is_public&quot;</span><span style=color:#000;font-weight:700>&gt;</span></span>False<span style=color:#090><span style=color:#000;font-weight:700>&lt;/field<span style=color:#000;font-weight:700>&gt;</span></span></span>
		<span style=color:#090><span style=color:#000;font-weight:700>&lt;field</span> <span style=color:#006>type</span>=<span style=color:red>&quot;CharField&quot;</span> <span style=color:#006>name</span>=<span style=color:red>&quot;page_public_id&quot;</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#000;font-weight:700>&lt;/field<span style=color:#000;font-weight:700>&gt;</span></span></span>
	<span style=color:#090><span style=color:#000;font-weight:700>&lt;/object<span style=color:#000;font-weight:700>&gt;</span></span></span>
<span style=color:#090><span style=color:#000;font-weight:700>&lt;/django-objects<span style=color:#000;font-weight:700>&gt;</span></span></span></pre></td></tr></table></div><p>いろいろと試した結果、復元時にpk(primary key)を変えた場合にそのpkを持つフィールドのデータを上書きすることができるとわかった。</p><p>以下のようなxmlファイルを含めて復元し、再びバックアップをダウンロードすると、pk=1のデータの入ったバックアップファイルが手に入り、pk=1のデータにflagが書かれていた。</p><div class=wp_syntax style=position:relative><table><tr><td class=code><pre class=xml style=font-family:monospace><span style=color:#090><span style=color:#000;font-weight:700>&lt;?xml</span> <span style=color:#006>version</span>=<span style=color:red>&quot;1.0&quot;</span> <span style=color:#006>encoding</span>=<span style=color:red>&quot;utf-8&quot;</span><span style=color:#000;font-weight:700>?&gt;</span></span>
<span style=color:#090><span style=color:#000;font-weight:700>&lt;django-objects</span> <span style=color:#006>version</span>=<span style=color:red>&quot;1.0&quot;</span><span style=color:#000;font-weight:700>&gt;</span></span>
	<span style=color:#090><span style=color:#000;font-weight:700>&lt;object</span> <span style=color:#006>pk</span>=<span style=color:red>&quot;1&quot;</span> <span style=color:#006>model</span>=<span style=color:red>&quot;hosting.pagesettings&quot;</span><span style=color:#000;font-weight:700>&gt;</span></span>
		<span style=color:#090><span style=color:#000;font-weight:700>&lt;field</span> <span style=color:#006>type</span>=<span style=color:red>&quot;CharField&quot;</span> <span style=color:#006>name</span>=<span style=color:red>&quot;owner_name&quot;</span><span style=color:#000;font-weight:700>&gt;</span></span>username<span style=color:#090><span style=color:#000;font-weight:700>&lt;/field<span style=color:#000;font-weight:700>&gt;</span></span></span>
	<span style=color:#090><span style=color:#000;font-weight:700>&lt;/object<span style=color:#000;font-weight:700>&gt;</span></span></span>
<span style=color:#090><span style=color:#000;font-weight:700>&lt;/django-objects<span style=color:#000;font-weight:700>&gt;</span></span></span></pre></td></tr></table></div></p></div><div class=prev-next><div class=prev-post><p><a href=/archive/p697.html>&#8592;
Previous:
DIMVA CTF 2013 writeup</a></p><p class=prev-post-date>July 19, 2013</p></div><div class=next-post><p><a href=/archive/p730.html>Next:
DEF CON CTF Qualifier 2013
&#8594;</a></p><p class=next-post-date>October 5, 2013</p></div></div></div></main><footer class=footer><span>&copy; 2023</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/526avijitgupta/gokarna>Gokarna</a></span></footer></body></html>