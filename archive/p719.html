<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>UFO CTF 2013 writeup – Web200</title><meta name=description content><meta name=keywords content><meta property="og:url" content="https://blog.tyage.net/archive/p719.html"><meta property="og:type" content="website"><meta property="og:title" content="UFO CTF 2013 writeup – Web200"><meta property="og:description" content><meta property="og:image" content="https://blog.tyage.net/icon/icon.jpg"><meta property="og:image:secure_url" content="https://blog.tyage.net/icon/icon.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="UFO CTF 2013 writeup – Web200"><meta name=twitter:description content><meta property="twitter:domain" content="https://blog.tyage.net/archive/p719.html"><meta property="twitter:url" content="https://blog.tyage.net/archive/p719.html"><meta name=twitter:image content="https://blog.tyage.net/icon/icon.jpg"><link rel=canonical href=https://blog.tyage.net/archive/p719.html><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.edd985581bf860dfb4507e5885197f1680160c7fe19f23b31e183126d99dd596.js integrity="sha256-7dmFWBv4YN+0UH5YhRl/FoAWDH/hnyOzHhgxJtmd1ZY="></script>
<script src=/redirect.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-C64TPJYY96"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-C64TPJYY96")</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1507795450221855" crossorigin=anonymous></script></head><body><script type=text/javascript>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://blog.tyage.net><img src=https://blog.tyage.net/icon/icon.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://blog.tyage.net>blog.tyage.net</a></div><div class=nav-links><div class=nav-link><a href=https://blog.tyage.net/post><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://blog.tyage.net/index.xml><span data-feather=rss></span> RSS</a></div><div class=nav-link><a href=https://tyage.net><span data-feather=home></span> About me</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only></span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span id=hamburger-menu-toggle-screen-reader-target class=sr-only>menu</span>
<a><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://blog.tyage.net/post><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://blog.tyage.net/index.xml><span data-feather=rss></span> RSS</a></li><li class=nav-item><a href=https://tyage.net><span data-feather=home></span> About me</a></li><li class="nav-item dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only>theme</span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container h-entry"><div class=post-header-section><h1 class=p-name>UFO CTF 2013 writeup – Web200</h1><small role=doc-subtitle></small><p class=post-date>2013/10/05 02:55:08</p><ul class=post-tags></ul></div><div class="post-content e-content"><p><pre>
Those aliens consider themselves as the most smart creatures in
the world. Pff. They shouldn't even have tried to defeat mankind
having such stupid stuff in their heads! As for you, why wouldn't
you hack them? They'll most likely surrender then. By the way, it
is known that they update some data every 10-20 seconds, but
unfortunately our equipment can't intercept the data itself.
 
http://superhosting.tasks.ufoctf.ru:8000/
</pre><p>自分のウェブページが作れ、バックアップと復元ができるシステムになっている。</p><p>バックアップしてみると、[username]_[md5(username)][md5(zipfile)].zipという名前でzipファイルがダウンロードでき、それをアップロードすることで復元ができるようになっている。<br>zipファイルの中身を解凍すると、.backupという名前で以下のようなファイルが入っている。</p><div class=wp_syntax style=position:relative><table><tr><td class=code><pre class=xml style=font-family:monospace><span style=color:#090><span style=color:#000;font-weight:700>&lt;?xml</span> <span style=color:#006>version</span>=<span style=color:red>&quot;1.0&quot;</span> <span style=color:#006>encoding</span>=<span style=color:red>&quot;utf-8&quot;</span><span style=color:#000;font-weight:700>?&gt;</span></span>
<span style=color:#090><span style=color:#000;font-weight:700>&lt;django-objects</span> <span style=color:#006>version</span>=<span style=color:red>&quot;1.0&quot;</span><span style=color:#000;font-weight:700>&gt;</span></span>
	<span style=color:#090><span style=color:#000;font-weight:700>&lt;object</span> <span style=color:#006>pk</span>=<span style=color:red>&quot;12349813568&quot;</span> <span style=color:#006>model</span>=<span style=color:red>&quot;hosting.pagesettings&quot;</span><span style=color:#000;font-weight:700>&gt;</span></span>
		<span style=color:#090><span style=color:#000;font-weight:700>&lt;field</span> <span style=color:#006>type</span>=<span style=color:red>&quot;CharField&quot;</span> <span style=color:#006>name</span>=<span style=color:red>&quot;owner_name&quot;</span><span style=color:#000;font-weight:700>&gt;</span></span>username<span style=color:#090><span style=color:#000;font-weight:700>&lt;/field<span style=color:#000;font-weight:700>&gt;</span></span></span>
		<span style=color:#090><span style=color:#000;font-weight:700>&lt;field</span> <span style=color:#006>type</span>=<span style=color:red>&quot;CharField&quot;</span> <span style=color:#006>name</span>=<span style=color:red>&quot;owner_email&quot;</span><span style=color:#000;font-weight:700>&gt;</span></span>test@localhost<span style=color:#090><span style=color:#000;font-weight:700>&lt;/field<span style=color:#000;font-weight:700>&gt;</span></span></span>
		<span style=color:#090><span style=color:#000;font-weight:700>&lt;field</span> <span style=color:#006>type</span>=<span style=color:red>&quot;CharField&quot;</span> <span style=color:#006>name</span>=<span style=color:red>&quot;page_title&quot;</span><span style=color:#000;font-weight:700>&gt;</span></span>My homepage<span style=color:#090><span style=color:#000;font-weight:700>&lt;/field<span style=color:#000;font-weight:700>&gt;</span></span></span>
		<span style=color:#090><span style=color:#000;font-weight:700>&lt;field</span> <span style=color:#006>type</span>=<span style=color:red>&quot;TextField&quot;</span> <span style=color:#006>name</span>=<span style=color:red>&quot;page_content&quot;</span><span style=color:#000;font-weight:700>&gt;</span></span>Hello everyone! This is my new homepage.<span style=color:#090><span style=color:#000;font-weight:700>&lt;/field<span style=color:#000;font-weight:700>&gt;</span></span></span>
		<span style=color:#090><span style=color:#000;font-weight:700>&lt;field</span> <span style=color:#006>type</span>=<span style=color:red>&quot;CharField&quot;</span> <span style=color:#006>name</span>=<span style=color:red>&quot;page_footer&quot;</span><span style=color:#000;font-weight:700>&gt;</span></span>Made with love and care<span style=color:#090><span style=color:#000;font-weight:700>&lt;/field<span style=color:#000;font-weight:700>&gt;</span></span></span>
		<span style=color:#090><span style=color:#000;font-weight:700>&lt;field</span> <span style=color:#006>type</span>=<span style=color:red>&quot;BooleanField&quot;</span> <span style=color:#006>name</span>=<span style=color:red>&quot;page_is_public&quot;</span><span style=color:#000;font-weight:700>&gt;</span></span>False<span style=color:#090><span style=color:#000;font-weight:700>&lt;/field<span style=color:#000;font-weight:700>&gt;</span></span></span>
		<span style=color:#090><span style=color:#000;font-weight:700>&lt;field</span> <span style=color:#006>type</span>=<span style=color:red>&quot;CharField&quot;</span> <span style=color:#006>name</span>=<span style=color:red>&quot;page_public_id&quot;</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#000;font-weight:700>&lt;/field<span style=color:#000;font-weight:700>&gt;</span></span></span>
	<span style=color:#090><span style=color:#000;font-weight:700>&lt;/object<span style=color:#000;font-weight:700>&gt;</span></span></span>
<span style=color:#090><span style=color:#000;font-weight:700>&lt;/django-objects<span style=color:#000;font-weight:700>&gt;</span></span></span></pre></td></tr></table></div><p>いろいろと試した結果、復元時にpk(primary key)を変えた場合にそのpkを持つフィールドのデータを上書きすることができるとわかった。</p><p>以下のようなxmlファイルを含めて復元し、再びバックアップをダウンロードすると、pk=1のデータの入ったバックアップファイルが手に入り、pk=1のデータにflagが書かれていた。</p><div class=wp_syntax style=position:relative><table><tr><td class=code><pre class=xml style=font-family:monospace><span style=color:#090><span style=color:#000;font-weight:700>&lt;?xml</span> <span style=color:#006>version</span>=<span style=color:red>&quot;1.0&quot;</span> <span style=color:#006>encoding</span>=<span style=color:red>&quot;utf-8&quot;</span><span style=color:#000;font-weight:700>?&gt;</span></span>
<span style=color:#090><span style=color:#000;font-weight:700>&lt;django-objects</span> <span style=color:#006>version</span>=<span style=color:red>&quot;1.0&quot;</span><span style=color:#000;font-weight:700>&gt;</span></span>
	<span style=color:#090><span style=color:#000;font-weight:700>&lt;object</span> <span style=color:#006>pk</span>=<span style=color:red>&quot;1&quot;</span> <span style=color:#006>model</span>=<span style=color:red>&quot;hosting.pagesettings&quot;</span><span style=color:#000;font-weight:700>&gt;</span></span>
		<span style=color:#090><span style=color:#000;font-weight:700>&lt;field</span> <span style=color:#006>type</span>=<span style=color:red>&quot;CharField&quot;</span> <span style=color:#006>name</span>=<span style=color:red>&quot;owner_name&quot;</span><span style=color:#000;font-weight:700>&gt;</span></span>username<span style=color:#090><span style=color:#000;font-weight:700>&lt;/field<span style=color:#000;font-weight:700>&gt;</span></span></span>
	<span style=color:#090><span style=color:#000;font-weight:700>&lt;/object<span style=color:#000;font-weight:700>&gt;</span></span></span>
<span style=color:#090><span style=color:#000;font-weight:700>&lt;/django-objects<span style=color:#000;font-weight:700>&gt;</span></span></span></pre></td></tr></table></div></p></div><div class=prev-next><div class=prev-post><p><a href=/archive/p697.html>&#8592;
Previous:
DIMVA CTF 2013 writeup</a></p><p class=prev-post-date>July 19, 2013</p></div><div class=next-post><p><a href=/archive/p730.html>Next:
DEF CON CTF Qualifier 2013
&#8594;</a></p><p class=next-post-date>October 5, 2013</p></div></div><div style=display:none><a class=u-bridgy-fed href=https://fed.brid.gy/></a>
<a class="p-author h-card" href=/>tyage</a><p class=dt-published>2013-10-05T02:55:08+00:00</p></div></div></main><footer class=footer><span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/526avijitgupta/gokarna>Gokarna</a></span></footer></body></html>