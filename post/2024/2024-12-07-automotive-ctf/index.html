<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>Automotive CTFの全xNexus問題のwriteup</title>
<meta name=description content><meta name=keywords content><meta property="og:url" content="https://blog.tyage.net/post/2024/2024-12-07-automotive-ctf/"><meta property="og:type" content="website"><meta property="og:title" content="Automotive CTFの全xNexus問題のwriteup"><meta property="og:description" content><meta property="og:image" content="https://blog.tyage.net/icon/icon.jpg"><meta property="og:image:secure_url" content="https://blog.tyage.net/icon/icon.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Automotive CTFの全xNexus問題のwriteup"><meta name=twitter:description content><meta property="twitter:domain" content="https://blog.tyage.net/post/2024/2024-12-07-automotive-ctf/"><meta property="twitter:url" content="https://blog.tyage.net/post/2024/2024-12-07-automotive-ctf/"><meta name=twitter:image content="https://blog.tyage.net/icon/icon.jpg"><link rel=canonical href=https://blog.tyage.net/post/2024/2024-12-07-automotive-ctf/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.9a920d7dabdbad8363b6a0a94e29a9dfebdb7ee64cfcb193a0145e512ef2bdab.js integrity="sha256-mpINfavbrYNjtqCpTimp3+vbfuZM/LGToBReUS7yvas="></script><link rel=webmention href=https://webmention.io/blog.tyage.net/webmention><link rel=pingback href=https://webmention.io/blog.tyage.net/xmlrpc><link rel=stylesheet type=text/css href=/css/style.css><script src=/js/redirect.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-C64TPJYY96"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-C64TPJYY96")</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1507795450221855" crossorigin=anonymous></script></head><body><script>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://blog.tyage.net/><img src=/icon/icon.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://blog.tyage.net/>blog.tyage.net</a></div><div class=nav-links><div class=nav-link><a href=https://blog.tyage.net/post><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://blog.tyage.net/index.xml><span data-feather=rss></span> RSS</a></div><div class=nav-link><a href=https://tyage.net><span data-feather=home></span> About me</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target"></span>
<a><span class=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span class="sr-only hamburger-menu-toggle-screen-reader-target">menu</span>
<a><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://blog.tyage.net/post><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://blog.tyage.net/index.xml><span data-feather=rss></span> RSS</a></li><li class=nav-item><a href=https://tyage.net><span data-feather=home></span> About me</a></li><li class="nav-item dark-theme-toggle"><span class="sr-only dark-theme-toggle-screen-reader-target">theme</span>
<a><span class=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container h-entry"><div class=post-header-section><h1 class=p-name>Automotive CTFの全xNexus問題のwriteup</h1><small role=doc-subtitle></small><p class=post-date>2024/12/07</p><ul class=post-tags></ul></div><div class=post-content><div class=e-content><p>会社チーム「ierae」としてAutomotive CTF 2024に参加しました。
国内予選・国内決勝・国際決勝の3ステージがあったのですが、全てのステージでxNexusというVicOne社の提供するプラットフォームに関連する問題が出ました。</p><p>チームメンバーの他の問題のwriteup: <a href=https://amenable-muscari-82a.notion.site/Automotive-CTF-15554c2c788a80609e26cd9fb1686a46>Automotive CTFのこと</a></p><p>特段技術的に興味深い内容というわけではないのですが、自分しか解いていない問題もあるため供養します。</p><h2 id=xnexus-web-rce-anomaly---automotive-ctf-2024-japan-予選>xNexus Web RCE Anomaly - Automotive CTF 2024 Japan 予選</h2><p>脅威分析プラットフォームであるxNexusのURLとアカウントが与えられるので、xNexusにログインしてどういった攻撃が飛んできたのかを調査するという問題です。
この問題に限らず、xNexusの問題は全て同じような形式です。</p><p>問題文</p><pre tabindex=0><code>An RCE has been logged in xNexus, what was the exploit used? The answer should be enclosed in the proper flag format of this game.

https://...
</code></pre><p>ログインするとShellshockが検知されていることが表示されており、それがフラグでした。</p><p>FLAG: <code>bh{shellshock}</code></p><h2 id=xnexus-can-bus-anomaly-1---automotive-ctf-2024-japan-予選>xNexus CAN Bus Anomaly #1 - Automotive CTF 2024 Japan 予選</h2><p>問題文</p><pre tabindex=0><code>Analyze CAN Bus Data anomalies and find the pattern. Answer should be enclosed in the standard format flag.
</code></pre><p>記録されているCANのデータを眺めていると、ASCIIの文字がちょくちょく出てきます。</p><p>うんうん唸りながらその断片を組み合わせてエスパーしながら何度もsubmitすると以下が正解でした。</p><p>FLAG: <code>bh{4nom4lyfl4g}</code></p><h2 id=xnexus-can-bus-anomaly-2---automotive-ctf-2024-japan-予選>xNexus CAN Bus Anomaly #2 - Automotive CTF 2024 Japan 予選</h2><p>問題文</p><pre tabindex=0><code>Someone is trying to disable the ESP and the power assisted system. Go track that anomaly with CAN ID 0x0645 and determine what car is being targeted for that kind of attack. The vehicle is the flag enclosed in the proper flag format.
</code></pre><p>次のようなデータが送信されており、ここからどの車種が攻撃されているかを特定する問題。</p><pre tabindex=0><code>0x00000645 023e000000000000
0x00000645 0211010000000000
0x00000645 0210020000000000
</code></pre><p>これ自体には車両の情報がないので、検索能力が問われています。
しかも車両を答えろとはどういうフォーマットで答えればいいのか不明です。</p><p>色々調べていると、コンテストの運営の人が公開しているGitHubリポジトリを見つけました。
このリポジトリに色々なCAN Busに対する攻撃スクリプトが置かれています。</p><p><a href=https://github.com/shipcod3/canTot>https://github.com/shipcod3/canTot</a></p><p><strong>以降、xNexus関連の問題に関しては全てこのリポジトリに答えがあります。</strong></p><p>この問題では以下のファイルに答えである<code>Tesla Model S P85</code>が書かれていました。</p><p><a href=https://github.com/shipcod3/canTot/blob/5bdfa6c64feba377a1ea4011da4f83db13431875/modules/tesla_disable_esp_abs.py>https://github.com/shipcod3/canTot/blob/5bdfa6c64feba377a1ea4011da4f83db13431875/modules/tesla_disable_esp_abs.py</a></p><p>FLAG: <code>bh{Tesla Model S P85}</code></p><h2 id=xnexus-can-bus-anomaly-1---automotive-ctf-2024-japan-決勝>xNexus CAN Bus Anomaly #1 - Automotive CTF 2024 Japan 決勝</h2><p>Automotive CTF 2024 Japan 決勝の問題です。</p><p>問題文</p><pre tabindex=0><code>&lt;日本語&gt; xNexusでCAN ID 0x3B9と0x3D1のCANバス異常を追跡して、その脆弱性IDを特定してください。ハッカーが通常参照するものを適切なフラグ形式で提出してください。
</code></pre><p>先ほどの問題と同じリポジトリで<code>0x3B9</code>を検索すると<code>CVE-2022-26269</code>が出てきました。</p><p><a href=https://github.com/shipcod3/canTot/blob/5bdfa6c64feba377a1ea4011da4f83db13431875/modules/ignis_zeta_fuel_seatbelt_spoof.py>https://github.com/shipcod3/canTot/blob/5bdfa6c64feba377a1ea4011da4f83db13431875/modules/ignis_zeta_fuel_seatbelt_spoof.py</a></p><p>FLAG: <code>bh{CVE-2022-26269}</code></p><h2 id=xnexus-can-bus-anomaly-2---automotive-ctf-2024-japan-決勝>xNexus CAN Bus Anomaly #2 - Automotive CTF 2024 Japan 決勝</h2><p>問題文</p><pre tabindex=0><code>&lt;日本語&gt; おっと、誰かが車両の全シリンダーへの燃料供給を停止するCANフレームを送信しています。完全なCANフレームを提供してください。 フラグ形式の例：bh{1337#0201}
</code></pre><p>またもや例のリポジトリで<code>cylinder</code>を検索すれば答えが出てきます。</p><p><a href=https://github.com/shipcod3/canTot/blob/5bdfa6c64feba377a1ea4011da4f83db13431875/modules/prius_park_killEngine.py>https://github.com/shipcod3/canTot/blob/5bdfa6c64feba377a1ea4011da4f83db13431875/modules/prius_park_killEngine.py</a></p><p>FLAG: bh{7e0#06301c000fa50100}</p><h2 id=xnexus-can-bus-anomaly-1---automotive-ctf-2024-finals>xNexus CAN Bus Anomaly #1 - Automotive CTF 2024 Finals</h2><p>アメリカ デトロイトで開催された決勝戦の問題です。
弊チームだけが解いた問題です。</p><p>問題文</p><pre tabindex=0><code>Description: Don&#39;t DDoS me, Bro! Track the CAN Bus anomaly in xNexus that performs this attack and determine what kind of attack it is.
</code></pre><p>ログインすると<code>0000000000000000</code>というCAN Frameが見えたので、例のリポジトリを漁ります。
firehoseという攻撃名らしい。</p><p><a href=https://github.com/shipcod3/canTot/blob/5bdfa6c64feba377a1ea4011da4f83db13431875/modules/kill_bus.py>https://github.com/shipcod3/canTot/blob/5bdfa6c64feba377a1ea4011da4f83db13431875/modules/kill_bus.py</a></p><p>FLAG: <code>bh{firehose}</code></p><h2 id=xnexus-can-bus-anomaly-2---automotive-ctf-2024-finals>xNexus CAN Bus Anomaly #2 - Automotive CTF 2024 Finals</h2><p>問題文</p><pre tabindex=0><code>Someone is trying to kill my engine. Determine what vehicle I am driving including the year by tracking CAN ID 0x7E0. Flag Format example: bh{Toyota Hilux 2021}
</code></pre><p>例のリポジトリで<code>0x7E0</code>を検索すれば答えが出てきます。</p><p><a href=https://github.com/shipcod3/canTot/blob/5bdfa6c64feba377a1ea4011da4f83db13431875/modules/ford_escape_kill_engine.py>https://github.com/shipcod3/canTot/blob/5bdfa6c64feba377a1ea4011da4f83db13431875/modules/ford_escape_kill_engine.py</a></p><p>FLAG: <code>bh{Ford Escape 2010}</code></p></div></div><div class=prev-next><div class=prev-post><p><a href=/post/2024/2024-07-18-xs-search-vs-coop/>&#8592;
Previous:
COOPがタイミング系のXS-Searchの緩和策にもなるらしい</a></p><p class=prev-post-date>2024/07/18</p></div></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg>
<script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function scrollToTop(){window.scrollTo(0,0)}</script><div id=comments><script src=/js/webmention.min.js data-max-webmentions=60 async></script><div id=webmentions></div></div><div style=display:none><a class=u-bridgy-fed href=https://fed.brid.gy/></a><p class=dt-published>2024-12-07T17:52:58+09:00</p></div></div></main><footer class=footer><span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/526avijitgupta/gokarna>Gokarna</a></span></footer></body></html>