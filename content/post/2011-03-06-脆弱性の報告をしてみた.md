---
title: 脆弱性の報告をしてみた
author: tyage
type: post
date: 2011-03-06T08:00:10+00:00
url: /archive/p278.html
has_been_twittered:
  - yes
categories:
  - 日々
tags:
  - セキュリティ

---
<p><a href="http://www.ustream.tv/recorded/13096296">セプキャンキャラバンのUST</a>を見ながらとあるWebサービスを使っていたら、うっかり脆弱性を発見してしまったため、とりあえずお問い合わせフォームから報告してみた。</p>
<p>試験中にも関わらず・・・</p>
<p>特定に繋がりそうなところは隠してあります。</p>
<blockquote><p>
****を楽しく使わせていただいております。</p>
<p>この度、****において脆弱性があることが分かりましたので報告させていただきます。</p>
<p>1.<br />
&#8211; 現象 &#8211;<br />
「****」や「****」ページにおいて任意のJavaScriptが実行出来る。</p>
<p>以下のページのように「****」や「****」ページにて任意のJavaScriptが実行されてしまいます。<br />
例：http://****.***/****<br />
例：http://****.***/****</p>
<p>&#8211; 想定される被害 &#8211;<br />
アクセスしてきたユーザーのCookieからトークンを盗み出すことにより、不正なログインが可能となります。<br />
また、アクセスしてきた時点で閲覧ユーザーの設定を変えるなどの行為も可能です。</p>
<p>&#8211; 解決策 &#8211;<br />
以下の情報を表示する際に適切なエスケープを行うことで回避が可能です。<br />
・「****」における****と****<br />
・「****」における、****と****<br />
・「****」における、****と****</p>
<p>2.<br />
&#8211; 現象 &#8211;<br />
****ページにおいて任意のJavaScriptが実行出来る。</p>
<p>以下のページのようなURLにユーザーがアクセスすることにより、任意のJavaScriptが実行されてしまいます。<br />
http://****.***/****</p>
<p>JavaScriptが****に埋めこまれている場合は、****ページなどからその****のリンクをクリックすることで上記URLにアクセスすることが起こりえます。<br />
また、単純に上記URLに他のサイトからアクセスさせることなどでも起こりえます。</p>
<p>&#8211; 想定される被害 &#8211;<br />
アクセスしてきたユーザーのCookieからトークンを盗み出すことにより、不正なログインが可能となります。<br />
また、アクセスしてきた時点で閲覧ユーザーの設定を変えるなどの行為も可能です。</p>
<p>&#8211; 解決策 &#8211;<br />
meta要素内のname属性の値にパラメータを入れているため、それを適切にエスケープすることで解決できます。</p>
<p>他にも、被害は起こり得ないと思われますが、****を****から閲覧した際に任意のJavaScriptが実行可能となっておりました。</p>
<p>以上です。長文失礼いたしました。
</p></blockquote>
<p>セプキャンでやったのを思い出して、現象と被害と解決策を書いて、お問い合わせフォームから送信してみた。<br />
ちゃんと資料引っ張ってくればよかった。</p>
<p>説明難しいし、どっか足りないかもしれない。</p>
<p>現象の部分にURLを貼りつけたのはまずかったかもしれない。<br />
「URLにアクセスしたら自分の情報を抜き出されるかもしれない」と警戒される可能性もあるし。。。</p>
<p>しかし自分の口で説明するのはどうも難しかったのでこういう方法を取ってしまった。</p>
<p>どうしたらよかっただろうか。。。</p>
<p>追記：</p>
<blockquote><p>
先ほどメールしたものです。</p>
<p>二つ目の現象において、以下のようなURLでも任意のJavaScriptが実行可能であることが分かりました。</p>
<p>http://****/***</p>
<p>これは、アクセスしてきたユーザーがログインしている場合に限りますが、URLにアクセスさせるだけでやはり問題は起こり得ます。</p>
<p>こちらからは報告しかできませんが、対応していただけるとありがたいです。
</p></blockquote>
<p>追記の追記：<br />
追記にてURLが見える状態になっておりました。<br />
申し訳ありません。</p>
<p>追追追記：<br />
修正されてました！<br />
ありがとうございます！</p>
