<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Overview of all pages with the category #メモ - blog.tyage.net</title><meta name=description content="Overview of all pages with the category #メモ, such as: 嘘つきPHP ZipArchive::addGlobと壊れたファイルパス"><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"blog.tyage.net","url":"https:\/\/blog.tyage.dev\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/blog.tyage.dev\/"}</script><meta property="og:title" content="メモ"><meta property="og:url" content="https://blog.tyage.dev/categories/%E3%83%A1%E3%83%A2/"><meta property="og:type" content="website"><meta property="og:site_name" content="blog.tyage.net"><meta name=twitter:title content="メモ"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.69.0"><link rel=alternate href=https://blog.tyage.dev/index.xml type=application/rss+xml title=blog.tyage.net><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css integrity=sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.5.0/css/all.css integrity=sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU crossorigin=anonymous><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link rel=stylesheet href=https://blog.tyage.dev/css/main.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"><link rel=stylesheet href=https://blog.tyage.dev/css/syntax.css><link rel=stylesheet href=https://blog.tyage.dev/css/codeblock.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css integrity=sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css integrity=sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R crossorigin=anonymous></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span></button>
<a class=navbar-brand href=https://blog.tyage.dev/>blog.tyage.net</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"></ul></div></div></nav><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=categories-heading><h1>メモ</h1><hr class=small></div></div></div></div></div></header><div class=container role=main><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=posts-list><article class=post-preview><a href=https://blog.tyage.dev/p944/><h2 class=post-title>嘘つきPHP ZipArchive::addGlobと壊れたファイルパス</h2></a><p class=post-meta><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on December 5, 2016
&nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;tyage</span></p><div class=post-entry>こんにちは.
KMC5回生のtyageです.
この記事は, KMCアドベントカレンダー 5日目の記事です.
昨日はnonyleneさんの Android Studio をビルドする でした.
唐突ですが, 今日はPHPの話をします.
TL;DR PHPのZipArchiveライブラリには, globパターンでファイルを追加する addGlob メソッドがある.
これにはいくつかoptionが指定できるのだが, 挙動がおかしい.
送った修正PRに反応をもらえたため, 12/1にリリースされた PHP 7.1 に含まれないかなと期待していたが, 特に進展はなかった.
みんな困ってないんか&#8230;?
ZipArchive::addGlob PHPでオシゴトをしていると, PHPでZipファイルを作りたい瞬間があるのではないかと思います.
私も, リクエスト内容が書かれたjsonファイルや画像をZipファイルでまとめてPOSTする超コズミックなAPIを叩く, 最高の機会がありました. (社会の歯車である一労働者は, 用意されたAPIに文句を言う前に黙々と作業をしなければいけない時があります.)
また, 様々な都合でZip圧縮前のフォルダを残しておく必要があったため, こんなコードを書いたのです.
$dir = '/tmp/workdir/'; &nbsp; // create jsons/api.json $jsonDir = $dir . 'jsons'; mkdir($jsonDir); file_put_contents($jsonDir. 'api.json', json_encode($request)); &nbsp; // create archive.zip $zip = new ZipArchive(); $zip->open($dir . 'archive.zip', ZipArchive::CREATE); $zip->addGlob($dir . '**/**', 0, ['remove_path' => $dir]); $zip->close(); ZipArchive::addGlobは, 第一引数にファイル検索パターンを, 第二引数にglobのフラグを, 第三引数にその他optionを指定します.
<a href=https://blog.tyage.dev/p944/ class=post-read-more>[Read More]</a></div></article><article class=post-preview><a href=https://blog.tyage.dev/p848/><h2 class=post-title>:visitedセレクタのプライバシー問題とSNSでの利用</h2></a><p class=post-meta><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on January 4, 2015
&nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;tyage</span></p><div class=post-entry>追記(2015年9月9日) 以下の記事は、2015年1月4日時点での内容となります。
2015年9月9日時点において、IE11で:visitedなリンクに対して透過度を変更できる仕様は修正されているようです。
参考: CVE-2015-1765, Internet Explorer 用の累積的なセキュリティ更新プログラム (3058515)
:visitedセレクタについて 半年以上前に少し調べたことについてまとめてみたいと思います。
まずCSSの擬似セレクタに:visitedがあり、:visitedセレクタではプライバシーの問題上、使用可能なプロパティが制限されていることはご存知の方も多いと思います。
訪問済みリンクの要素にbackground-imageを設定することで、訪問済みリンクの情報が漏れるという問題等の対策です。
(Calm brilliance &#8211; CSS Fingerprint: preliminary data)
詳細は Privacy and the :visited selector にある通りですが、そこでは
You will still be able to visually style visited links, but there are now limits on what styles you can use. Only the following properties can be applied to visited links:
&#8211; color
&#8211; background-color
&#8211; border-color (and its sub-properties)
&#8211; outline-color
<a href=https://blog.tyage.dev/p848/ class=post-read-more>[Read More]</a></div></article><article class=post-preview><a href=https://blog.tyage.dev/p762/><h2 class=post-title>録画環境を構築した</h2></a><p class=post-meta><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on February 17, 2014
&nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;tyage</span></p><div class=post-entry>環境 ハードはこれ
OSは未だにUbuntu 12.04
録画するまで ここ数カ月はサラリーマン生活をしていて、朝10時に出勤しているのだけど、そうなるとさすがに夜更しがつらくなってきた。
深夜アニメを見る生活も捨てがたいし録画することにした。
PCで見たいので録画カードとしてPT3を買った。
届いてから設置して、Ubuntuにドライバを入れたりした。
PT3のドライバがgithubにあったので、すごい時代だなあと思いながらインストール。
recpt1が必要とのことだったのでこことかを参考にぐぐりながら入れて、再起動。
B-CASカードに関してはここでは述べないこととする。
録画管理にはepgdumpではなく、chinachuを使うことにした。
たまたま冬コミでマニュアルを手に入れていたこともあるけど、モダンな感じなのとnode.jsで書かれているのがいい感じ。
（epgdumpも入れてみたけどapacheやmysql依存してると開発環境とぶつかってよくない感じに・・・）
chinachuのWUIは結構充実してて、その場で番組視聴したり録画視聴できるのが嬉しい。
node.jsは既に入っていたし、wikiに書いてあるとおりにやったらすんなりいけた。
コマンド1回でだいたい終わるのはとても気持ちいい。
設定に関して、チャンネルは下のように総当たりでスキャンするか地域で調べるかすればよさげ。
for var in `seq 13 80` ; do recpt1 --b25 --strip $var 10 ./$var.ts;done ど素人だけど半日あれば十分だった。
エンコード問題 録画環境が構築できたので試しに録画してみた。
ある程度覚悟はしていたものの、30分のアニメでm2ts形式のファイルだと3GB前後といった感じだった。
うう〜ん。。。でかい。。。
とりあえずmp4に変換しようと思い、HandBrakeを使ってみる。
Linux環境でもQSVが使えるらしく、ffmpegよりエンコード速度が速いかもとのこと。
[追記: 2014/10/25]まだLinux環境でもサポートされていないようでした。
インストール時に注意なのが、「ppa:stebbins/handbrake-releases」には「handbrake」はなくて「handbrake-cli」と「handbrake-gtk」があるということ。
試しに比較してみると、30分のアニメで、HandBrakeだと20分、ffmpegだと60分以上かかった。
この時の圧縮後の容量はHandBrakeは400MB、ffmpegは600MBという感じだった。
HandBrakeのほうが画質が落ちているように見えるが、比較しなければ気にならない程度。
当然、エンコード方式等々で変わってくるだろうからコマンドを貼っておく。
ffmpeg -i in.m2ts -vcodec libx264 out.mp4 HandBrakeCLI -e x264 --deinterlace fast --h264-profile main --modulus 2 -q 22 --aencoder copy:aac -i in.m2ts -o out.mp4 適当にencodeしたので適切に圧縮されているのか少し不安である。
<a href=https://blog.tyage.dev/p762/ class=post-read-more>[Read More]</a></div></article><article class=post-preview><a href=https://blog.tyage.dev/p739/><h2 class=post-title>スペインでFirefox OS端末は買えるのか？</h2></a><p class=post-meta><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on December 4, 2013
&nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;tyage</span></p><div class=post-entry>この記事はKMCアドベントカレンダーの4日目の記事です。
1〜3日目の人達は技術系の記事を書いているため、僕は少し緩めの話をしようと思います。
僕は10月末〜11月初めまで、Facebook CTF決勝のためにチームEpsilonDeltaの4人でスペインにいました。
その時に、スペインで販売されているFirefox OS搭載の端末「ZTE Open」を購入しようとしたという話です。
もし今後スペインに行くことがあり、携帯端末を購入するという方の参考になればと思います。
※Facebook CTFに関する詳しい内容はC85で頒布する部誌に記事を載せているのでそちらをよろしくお願いします。
3日目 西地区 &#8221;し&#8221; ブロック 42bです。
よろしくお願いします。
3日目 西地区 &#8221;し&#8221; ブロック 42bです。
事の始まり Firefox OS搭載の端末は、先ほど出てきたZTE Openの他にもPeak・Peak+・Keonなどありますが、これらは既に品切れ状態が続いており（Peakは再生産するらしい？）ほとんど手に入らないようです。
ZTE Openが初めて販売されたのはスペインからということで少し話題になりました。(http://gigazine.net/news/20130710-firefox-os-smartphone-zte-open/)
ZTE Openはebayで輸入することができるため日本にいても手に入るのですが、輸入にかかる費用を含めて1万円弱($94.99 USD)かかります。
一方、スペインで買うと7000円弱(49 EUR)で手に入るとわかりました（運が良ければ中古で安く手に入らないかとも期待していた）。
せっかくスペインに行くのだしこれを自分へのおみやげにしようと決めて出発したのでした。
11/3 朝 スペイン・バルセロナ自体には10/30昼〜11/4昼までいたのですが、CTFがあったりその他に行く場所があったりして、ZTE Openを探す時間ができたのは11/3と11/4になってしまいました。
11/3も観光地に寄る予定を組んでいたために、朝に1時間ほどしか動けませんでした。
しかもこの日は日曜日。
スペインでは日曜日になるとほぼ全ての店が閉まってしまいます。（日本だと異常事態ですね。）
ということでこの日はどこに行っても閉店・・・（流石に一部のコンビニや観光地のショップは開いていましたが）
ホテル付近の店は全滅という状態で諦めざるを得ませんでした。
スペインに行く際は日曜日(domingo)に気をつけて下さい。
11/4 9:30 この日は最終日なので9:30-12:00までの間に急いで探さないと行けませんでした。
前日に調べた結果、とりあえずホテルのすぐ近くにあるmovistar直営店に寄ることにしました。
movistarというのはスペイン語圏の国々で主に活動している会社で、スペインで最大の携帯事業会社となっています。
世界第5位の通信事業会社Telefónicaの子会社でもあります。
スペイン最大ということもあって、バルセロナの町の至る所にmovistarの直営店がありました。
（その他にはvodafoneやorangeやyoigoといった会社が多く見られました。）
どこにmovistarがあるのかはこのページで確認することができるのですが、本当にバルセロナを埋め尽くしているという感じです。
スペインではこのmovistarがZTE Openを取り扱っているらしく、実際に店頭に並べられていたり広告が貼られているのは事前に確認済みです。
このような特設ページも作られています。
http://www.movistar.es/firefoxos
スペイン語がわからない人間のために英語で書かれたZTE Open購入マニュアルも見つけました。
How to Buy ZTE Open – Step by Step Guide
これで準備も万全だ！と満を持してmovistarに入ると、スペイン人のお姉ちゃんが1人で店番をしているだけでした。
僕「Hola!」
<a href=https://blog.tyage.dev/p739/ class=post-read-more>[Read More]</a></div><div class=blog-tags><a href=https://blog.tyage.dev//tags/firefoxos/>FirefoxOS</a>&nbsp;</div></article><article class=post-preview><a href=https://blog.tyage.dev/p605/><h2 class=post-title>何か吐き出さないとなあ</h2></a><p class=post-meta><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on November 18, 2012
&nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;tyage</span></p><div class=post-entry><p>　<br>ここんところ某つぶやきサイトでうだうだ言ってるだけで、こうやって書くことがないからか、よくわからないストレスが溜まっている。<br>いろいろなことがあって（でも何もできてないのだけど）何か書かないといけないと思った。</p><p>とりあえず、以下のことについて書くつもりでいる。<br>・ウェブセキュリティ勉強会/OWASP Japan （大阪サテライト）<br>・会社でまた働き始めたこと<br>・情報セキュリティワークショップin越後湯沢<br>・アイデアソン<br>・SECCON CTF<br>・きょーくりっのワークショップ<br>・学校や、普段の生活のこと<br>・今まで一人でやっていたプロジェクトやプログラミングについて</p><p>こぼしたいことはあるはずなのに、なぜか手が進まないのでこうやって自分にプレッシャーをかけてみる。</p><p>自然とインプットもアウトプットもしなくなってから、自分が何をしているのかわからなくなったので振り返ればと思う。</p><p>ただ、NF（京大11月祭）も近いので、またどうなることやら・・・</p></div></article><article class=post-preview><a href=https://blog.tyage.dev/p243/><h2 class=post-title>google mapsでマーカーに文字を表示させたい</h2></a><p class=post-meta><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on January 19, 2011
&nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;tyage</span></p><div class=post-entry><p>たとえばマーカーのアイコン画像の下に文字を表示したい。</p><p>こんな感じに<br><a href=https://blog.tyage.net/wp-content/uploads/2011/01/maps.png><img data-attachment-id=244 data-permalink="https://blog.tyage.net/?attachment_id=244" data-orig-file=https://blog.tyage.net/wp-content/uploads/2011/01/maps.png data-orig-size=370,330 data-comments-opened=1 data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-image-title=maps data-image-description data-medium-file=https://blog.tyage.net/wp-content/uploads/2011/01/maps.png data-large-file=https://blog.tyage.net/wp-content/uploads/2011/01/maps.png src=https://blog.tyage.net/wp-content/uploads/2011/01/maps.png alt title=maps width=370 height=330 class="alignnone size-full wp-image-244"></a></p><p>この画像ではマーカーの代わりにoverlayViewを継承したカスタムオーバーレイを使っている。</p><p>実際そうすれば問題はないんだけど、そうなると<a href=http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclusterer/docs/reference.html>MarkerClustererライブラリ</a>が使えない。</p><p>どうしても使いたい。<br>代わりになるものがあればそれでいいけど。。</p><p>あきらめてcanvasに文字を書いてdataスキームで画像として表示するとか・・・？</p></div><div class=blog-tags><a href=https://blog.tyage.dev//tags/google-maps/>Google Maps</a>&nbsp;</div></article></div></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"></ul><p class="credits copyright text-muted">&nbsp;&bull;&nbsp;&copy;
2018
&nbsp;&bull;&nbsp;
<a href=https://blog.tyage.dev/>blog.tyage.net</a></p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Hugo v0.69.0</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js integrity=sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js integrity=sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe crossorigin=anonymous></script><script src=https://code.jquery.com/jquery-1.12.4.min.js integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin=anonymous></script><script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script><script src=https://blog.tyage.dev/js/main.js></script><script>renderMathInElement(document.body);</script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js integrity=sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js integrity=sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q crossorigin=anonymous></script><script src=https://blog.tyage.dev/js/load-photoswipe.js></script></body></html>