<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>メモ</title><meta name=description content="Talk about daily things"><meta name=keywords content><meta property="og:url" content="https://blog.tyage.net/categories/%E3%83%A1%E3%83%A2/"><meta property="og:type" content="website"><meta property="og:title" content="メモ"><meta property="og:description" content="Talk about daily things"><meta property="og:image" content="https://blog.tyage.net/icon/icon.jpg"><meta property="og:image:secure_url" content="https://blog.tyage.net/icon/icon.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="メモ"><meta name=twitter:description content="Talk about daily things"><meta property="twitter:domain" content="https://blog.tyage.net/categories/%E3%83%A1%E3%83%A2/"><meta property="twitter:url" content="https://blog.tyage.net/categories/%E3%83%A1%E3%83%A2/"><meta name=twitter:image content="https://blog.tyage.net/icon/icon.jpg"><link rel=canonical href=https://blog.tyage.net/categories/%E3%83%A1%E3%83%A2/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.edd985581bf860dfb4507e5885197f1680160c7fe19f23b31e183126d99dd596.js integrity="sha256-7dmFWBv4YN+0UH5YhRl/FoAWDH/hnyOzHhgxJtmd1ZY="></script>
<script src=/redirect.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-C64TPJYY96"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-C64TPJYY96")</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1507795450221855" crossorigin=anonymous></script></head><body><script type=text/javascript>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://blog.tyage.net><img src=https://blog.tyage.net/icon/icon.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://blog.tyage.net>blog.tyage.net</a></div><div class=nav-links><div class=nav-link><a href=https://blog.tyage.net/post><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://blog.tyage.net/index.xml><span data-feather=rss></span> RSS</a></div><div class=nav-link><a href=https://tyage.net><span data-feather=home></span> About me</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only></span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span id=hamburger-menu-toggle-screen-reader-target class=sr-only>menu</span>
<a><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://blog.tyage.net/post><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://blog.tyage.net/index.xml><span data-feather=rss></span> RSS</a></li><li class=nav-item><a href=https://tyage.net><span data-feather=home></span> About me</a></li><li class="nav-item dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only>theme</span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="container list-posts"><h1 class=list-title>メモ</h1><h2 class=posts-year>2016</h2><article class="post-title h-entry"><a href=https://blog.tyage.net/archive/p944.html class="post-link u-bridgy-fed p-name">嘘つきPHP ZipArchive::addGlobと壊れたファイルパス</a><div class=flex-break></div><span class="post-date dt-published">2016-12-05</span><div class=e-content style=display:none>こんにちは.
KMC5回生のtyageです.
この記事は, KMCアドベントカレンダー 5日目の記事です.
昨日はnonyleneさんの Android Studio をビルドする でした.
唐突ですが, 今日はPHPの話をします.
TL;DR PHPのZipArchiveライブラリには, globパターンでファイルを追加する addGlob メソッドがある.
これにはいくつかoptionが指定できるのだが, 挙動がおかしい.
送った修正PRに反応をもらえたため, 12/1にリリースされた PHP 7.1 に含まれないかなと期待していたが, 特に進展はなかった.
みんな困ってないんか&#8230;?
ZipArchive::addGlob PHPでオシゴトをしていると, PHPでZipファイルを作りたい瞬間があるのではないかと思います.
私も, リクエスト内容が書かれたjsonファイルや画像をZipファイルでまとめてPOSTする超コズミックなAPIを叩く, 最高の機会がありました. (社会の歯車である一労働者は, 用意されたAPIに文句を言う前に黙々と作業をしなければいけない時があります.)
また, 様々な都合でZip圧縮前のフォルダを残しておく必要があったため, こんなコードを書いたのです.
$dir = '/tmp/workdir/'; &nbsp; // create jsons/api.json $jsonDir = $dir . 'jsons'; mkdir($jsonDir); file_put_contents($jsonDir. 'api.json', json_encode($request)); &nbsp; // create archive.zip $zip = new ZipArchive(); $zip->open($dir . 'archive.zip', ZipArchive::CREATE); $zip->addGlob($dir . '**/**', 0, ['remove_path' => $dir]); $zip->close(); ZipArchive::addGlobは, 第一引数にファイル検索パターンを, 第二引数にglobのフラグを, 第三引数にその他optionを指定します.</div></article><h2 class=posts-year>2015</h2><article class="post-title h-entry"><a href=https://blog.tyage.net/archive/p848.html class="post-link u-bridgy-fed p-name">:visitedセレクタのプライバシー問題とSNSでの利用</a><div class=flex-break></div><span class="post-date dt-published">2015-01-04</span><div class=e-content style=display:none>追記(2015年9月9日) 以下の記事は、2015年1月4日時点での内容となります。
2015年9月9日時点において、IE11で:visitedなリンクに対して透過度を変更できる仕様は修正されているようです。
参考: CVE-2015-1765, Internet Explorer 用の累積的なセキュリティ更新プログラム (3058515)
:visitedセレクタについて 半年以上前に少し調べたことについてまとめてみたいと思います。
まずCSSの擬似セレクタに:visitedがあり、:visitedセレクタではプライバシーの問題上、使用可能なプロパティが制限されていることはご存知の方も多いと思います。
訪問済みリンクの要素にbackground-imageを設定することで、訪問済みリンクの情報が漏れるという問題等の対策です。
(Calm brilliance &#8211; CSS Fingerprint: preliminary data)
詳細は Privacy and the :visited selector にある通りですが、そこでは
You will still be able to visually style visited links, but there are now limits on what styles you can use. Only the following properties can be applied to visited links:
&#8211; color
&#8211; background-color
&#8211; border-color (and its sub-properties)
&#8211; outline-color
&#8211; The color parts of the fill and stroke properties</div></article><h2 class=posts-year>2014</h2><article class="post-title h-entry"><a href=https://blog.tyage.net/archive/p762.html class="post-link u-bridgy-fed p-name">録画環境を構築した</a><div class=flex-break></div><span class="post-date dt-published">2014-02-17</span><div class=e-content style=display:none>環境 ハードはこれ
OSは未だにUbuntu 12.04
録画するまで ここ数カ月はサラリーマン生活をしていて、朝10時に出勤しているのだけど、そうなるとさすがに夜更しがつらくなってきた。
深夜アニメを見る生活も捨てがたいし録画することにした。
PCで見たいので録画カードとしてPT3を買った。
届いてから設置して、Ubuntuにドライバを入れたりした。
PT3のドライバがgithubにあったので、すごい時代だなあと思いながらインストール。
recpt1が必要とのことだったのでこことかを参考にぐぐりながら入れて、再起動。
B-CASカードに関してはここでは述べないこととする。
録画管理にはepgdumpではなく、chinachuを使うことにした。
たまたま冬コミでマニュアルを手に入れていたこともあるけど、モダンな感じなのとnode.jsで書かれているのがいい感じ。
（epgdumpも入れてみたけどapacheやmysql依存してると開発環境とぶつかってよくない感じに・・・）
chinachuのWUIは結構充実してて、その場で番組視聴したり録画視聴できるのが嬉しい。
node.jsは既に入っていたし、wikiに書いてあるとおりにやったらすんなりいけた。
コマンド1回でだいたい終わるのはとても気持ちいい。
設定に関して、チャンネルは下のように総当たりでスキャンするか地域で調べるかすればよさげ。
for var in `seq 13 80` ; do recpt1 --b25 --strip $var 10 ./$var.ts;done ど素人だけど半日あれば十分だった。
エンコード問題 録画環境が構築できたので試しに録画してみた。
ある程度覚悟はしていたものの、30分のアニメでm2ts形式のファイルだと3GB前後といった感じだった。
うう〜ん。。。でかい。。。
とりあえずmp4に変換しようと思い、HandBrakeを使ってみる。
Linux環境でもQSVが使えるらしく、ffmpegよりエンコード速度が速いかもとのこと。
[追記: 2014/10/25]まだLinux環境でもサポートされていないようでした。
インストール時に注意なのが、「ppa:stebbins/handbrake-releases」には「handbrake」はなくて「handbrake-cli」と「handbrake-gtk」があるということ。
試しに比較してみると、30分のアニメで、HandBrakeだと20分、ffmpegだと60分以上かかった。
この時の圧縮後の容量はHandBrakeは400MB、ffmpegは600MBという感じだった。
HandBrakeのほうが画質が落ちているように見えるが、比較しなければ気にならない程度。
当然、エンコード方式等々で変わってくるだろうからコマンドを貼っておく。
ffmpeg -i in.m2ts -vcodec libx264 out.mp4 HandBrakeCLI -e x264 --deinterlace fast --h264-profile main --modulus 2 -q 22 --aencoder copy:aac -i in.m2ts -o out.mp4 適当にencodeしたので適切に圧縮されているのか少し不安である。</div></article><h2 class=posts-year>2013</h2><article class="post-title h-entry"><a href=https://blog.tyage.net/archive/p739.html class="post-link u-bridgy-fed p-name">スペインでFirefox OS端末は買えるのか？</a><div class=flex-break></div><span class="post-date dt-published">2013-12-04</span><div class=e-content style=display:none>この記事はKMCアドベントカレンダーの4日目の記事です。
1〜3日目の人達は技術系の記事を書いているため、僕は少し緩めの話をしようと思います。
僕は10月末〜11月初めまで、Facebook CTF決勝のためにチームEpsilonDeltaの4人でスペインにいました。
その時に、スペインで販売されているFirefox OS搭載の端末「ZTE Open」を購入しようとしたという話です。
もし今後スペインに行くことがあり、携帯端末を購入するという方の参考になればと思います。
※Facebook CTFに関する詳しい内容はC85で頒布する部誌に記事を載せているのでそちらをよろしくお願いします。
3日目 西地区 &#8221;し&#8221; ブロック 42bです。
よろしくお願いします。
3日目 西地区 &#8221;し&#8221; ブロック 42bです。
事の始まり Firefox OS搭載の端末は、先ほど出てきたZTE Openの他にもPeak・Peak+・Keonなどありますが、これらは既に品切れ状態が続いており（Peakは再生産するらしい？）ほとんど手に入らないようです。
ZTE Openが初めて販売されたのはスペインからということで少し話題になりました。(http://gigazine.net/news/20130710-firefox-os-smartphone-zte-open/)
ZTE Openはebayで輸入することができるため日本にいても手に入るのですが、輸入にかかる費用を含めて1万円弱($94.99 USD)かかります。
一方、スペインで買うと7000円弱(49 EUR)で手に入るとわかりました（運が良ければ中古で安く手に入らないかとも期待していた）。
せっかくスペインに行くのだしこれを自分へのおみやげにしようと決めて出発したのでした。
11/3 朝 スペイン・バルセロナ自体には10/30昼〜11/4昼までいたのですが、CTFがあったりその他に行く場所があったりして、ZTE Openを探す時間ができたのは11/3と11/4になってしまいました。
11/3も観光地に寄る予定を組んでいたために、朝に1時間ほどしか動けませんでした。
しかもこの日は日曜日。
スペインでは日曜日になるとほぼ全ての店が閉まってしまいます。（日本だと異常事態ですね。）
ということでこの日はどこに行っても閉店・・・（流石に一部のコンビニや観光地のショップは開いていましたが）
ホテル付近の店は全滅という状態で諦めざるを得ませんでした。
スペインに行く際は日曜日(domingo)に気をつけて下さい。
11/4 9:30 この日は最終日なので9:30-12:00までの間に急いで探さないと行けませんでした。
前日に調べた結果、とりあえずホテルのすぐ近くにあるmovistar直営店に寄ることにしました。
movistarというのはスペイン語圏の国々で主に活動している会社で、スペインで最大の携帯事業会社となっています。
世界第5位の通信事業会社Telefónicaの子会社でもあります。
スペイン最大ということもあって、バルセロナの町の至る所にmovistarの直営店がありました。
（その他にはvodafoneやorangeやyoigoといった会社が多く見られました。）
どこにmovistarがあるのかはこのページで確認することができるのですが、本当にバルセロナを埋め尽くしているという感じです。
スペインではこのmovistarがZTE Openを取り扱っているらしく、実際に店頭に並べられていたり広告が貼られているのは事前に確認済みです。
このような特設ページも作られています。
http://www.movistar.es/firefoxos
スペイン語がわからない人間のために英語で書かれたZTE Open購入マニュアルも見つけました。
How to Buy ZTE Open – Step by Step Guide
これで準備も万全だ！と満を持してmovistarに入ると、スペイン人のお姉ちゃんが1人で店番をしているだけでした。
僕「Hola!」</div></article><h2 class=posts-year>2012</h2><article class="post-title h-entry"><a href=https://blog.tyage.net/archive/p605.html class="post-link u-bridgy-fed p-name">何か吐き出さないとなあ</a><div class=flex-break></div><span class="post-date dt-published">2012-11-18</span><div class=e-content style=display:none>ここんところ某つぶやきサイトでうだうだ言ってるだけで、こうやって書くことがないからか、よくわからないストレスが溜まっている。
いろいろなことがあって（でも何もできてないのだけど）何か書かないといけないと思った。
とりあえず、以下のことについて書くつもりでいる。
・ウェブセキュリティ勉強会/OWASP Japan （大阪サテライト）
・会社でまた働き始めたこと
・情報セキュリティワークショップin越後湯沢
・アイデアソン
・SECCON CTF
・きょーくりっのワークショップ
・学校や、普段の生活のこと
・今まで一人でやっていたプロジェクトやプログラミングについて
こぼしたいことはあるはずなのに、なぜか手が進まないのでこうやって自分にプレッシャーをかけてみる。
自然とインプットもアウトプットもしなくなってから、自分が何をしているのかわからなくなったので振り返ればと思う。
ただ、NF（京大11月祭）も近いので、またどうなることやら・・・</div></article><h2 class=posts-year>2011</h2><article class="post-title h-entry"><a href=https://blog.tyage.net/archive/p243.html class="post-link u-bridgy-fed p-name">google mapsでマーカーに文字を表示させたい</a><div class=flex-break></div><span class="post-date dt-published">2011-01-19</span><div class=e-content style=display:none>たとえばマーカーのアイコン画像の下に文字を表示したい。
こんな感じに
この画像ではマーカーの代わりにoverlayViewを継承したカスタムオーバーレイを使っている。
実際そうすれば問題はないんだけど、そうなるとMarkerClustererライブラリが使えない。
どうしても使いたい。
代わりになるものがあればそれでいいけど。。
あきらめてcanvasに文字を書いてdataスキームで画像として表示するとか・・・？</div></article></div></main><footer class=footer><span>&copy; <a href=https://tyage.net/ class=h-card rel=me>tyage</a></span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/526avijitgupta/gokarna>Gokarna</a></span></footer></body></html>