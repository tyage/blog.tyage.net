<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>CTF on blog.tyage.net</title><link>https://blog.tyage.net/categories/ctf/</link><description>Recent content in CTF on blog.tyage.net</description><generator>Hugo</generator><language>en-us</language><lastBuildDate>Tue, 26 Jun 2018 15:11:37 +0000</lastBuildDate><atom:link href="https://blog.tyage.net/categories/ctf/index.xml" rel="self" type="application/rss+xml"/><item><title>CSP Embedded Enforcementã§XSS mitigationã‚’bypassã™ã‚‹è©±</title><link>https://blog.tyage.net/archive/p1187.html</link><pubDate>Tue, 26 Jun 2018 15:11:37 +0000</pubDate><guid>https://blog.tyage.net/archive/p1187.html</guid><description>&lt;h2>ãªã«&lt;/h2>
&lt;p>CSP Embedded Enforcementã‚’ä½¿ã£ã¦ã€JavaScriptã§æ›¸ã‹ã‚ŒãŸXSS mitigationã‚’bypassã§ãã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒã‚ã‚‹ã¨ã„ã†è©±ã€‚&lt;br />
ä»¥ä¸‹ã®ã‚ˆã†ãªæ¡ä»¶ãŒå¿…è¦ãªã®ã§ç¾å®Ÿã«ä½¿ãˆã‚‹å ´é¢ã¯æ™®é€šã¯ãªã•ãã†ã€‚&lt;br />
CTFã§ã¯ä¾¿åˆ©ã‹ã‚‚ã—ã‚Œãªã„ã€‚&lt;/p>
&lt;ul>
&lt;li>Webãƒšãƒ¼ã‚¸ã§åŒä¸€ã‚ªãƒªã‚¸ãƒ³ã®ãƒšãƒ¼ã‚¸ã‚’iframeã§èª­ã¿è¾¼ã‚ã‚‹&lt;/li>
&lt;li>Webãƒšãƒ¼ã‚¸ã®ãƒ˜ãƒƒãƒ€ã«CSPãŒè¨­å®šã•ã‚Œã¦ã„ãªã„&lt;/li>
&lt;li>Webãƒšãƒ¼ã‚¸ã«æŒ‡å®šã—ãŸHTMLã‚’åŸ‹ã‚è¾¼ã‚ã‚‹(XSSãŒã§ãã‚‹)&lt;/li>
&lt;li>ãŸã ã—ã€Webãƒšãƒ¼ã‚¸ã«JavaScriptã«ã‚ˆã‚‹XSSé˜²å¾¡æ©Ÿæ§‹ãŒã‚ã‚‹&lt;/li>
&lt;/ul>
&lt;p>ã“ã®ã¨ãã€CSP Embedded Enforcementã‚’ä½¿ã†ã“ã¨ã§ã€é˜²å¾¡æ©Ÿæ§‹ã‚’å›é¿ã—ã¦æ”»æ’ƒã‚³ãƒ¼ãƒ‰ã ã‘ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚&lt;/p></description></item><item><title>SECCON 2017 Final International competition â€“ å‚ writeup</title><link>https://blog.tyage.net/archive/p1138.html</link><pubDate>Thu, 22 Mar 2018 15:20:40 +0000</pubDate><guid>https://blog.tyage.net/archive/p1138.html</guid><description>SECCON 2017å›½éš›æ±ºå‹ã«å‚åŠ ã—ãŸã€‚
5ç¨®é¡ã®KoHå½¢å¼ã®å•é¡Œã¨ã€ã„ãã¤ã‹ã®Jeopardyå½¢å¼ã®å•é¡ŒãŒå‡ºé¡Œã•ã‚ŒãŸã€‚
å•é¡Œå‚(KoH)ã®å•é¡Œæ–‡:
The Raspberry Pi distributed to each team contains the Bingo-Service program
Please log-in your Raspberry Pi ( ssh: 192.168.4.254, user/pass = pi/kenjiinwonderland )
Please set up Bingo-Service on 192.168.4.254 : 80
If you click &amp;#8220;Measure&amp;#8221; button above, the system will accesses your Bingo-Service in a few minutes later
&amp;#8220;Measure&amp;#8221; button can be clicked once every 7 minutes (Once you click it, you have to wait for 7 minutes)</description></item><item><title>Tokyo Westerns CTF 2017 â€“ Clock Style Sheet writeup</title><link>https://blog.tyage.net/archive/p1043.html</link><pubDate>Tue, 05 Sep 2017 01:34:28 +0000</pubDate><guid>https://blog.tyage.net/archive/p1043.html</guid><description>Overview Problem page:
http://css.chal.ctf.westerns.tokyo/
Provided source code:
proxy.py
sanitizer.py
There are 4 pages: /, /refresh, /chrowler, /flag.
When we access /flag, it responses only local IP is allowed. (your IP: 110.3.193.114).
So, we should use /chrowler (crawler using Chrome) to get the content in /flag.
Find XSS Next, we search XSS and found /refresh has it. (We found the vulnerability when browsing with w3m)
In this page, user will be redirected to the page where he or she is (which represented by Referer header).</description></item><item><title>Google CTF 2017 â€“ Geokitties v2 writeup</title><link>https://blog.tyage.net/archive/p1020.html</link><pubDate>Sun, 25 Jun 2017 17:04:34 +0000</pubDate><guid>https://blog.tyage.net/archive/p1020.html</guid><description>Overview Problem page:
https://geokittiesv2.web.ctfcompetition.com/
Copy of source code:
https://gist.github.com/tyage/cac08c8e17b90b840fb22cb434cff127
It receives comment, then admin checks it and clicks a link.
The comment is validated by using htmlparser2.
Allowed tags are: p, a, b, img, br, i
Invalid attributes: on(.*)= and href=javascript:...
Solution What we should do is find the differences in parsing between Google Chrome and htmlparser2.
After some time, I realize that when input is utf-16 string, Chrome parses it as utf-16 string but htmlparser2 does not.</description></item><item><title>Google CTF 2017 â€“ The X Sanitizer writeup</title><link>https://blog.tyage.net/archive/p990.html</link><pubDate>Sun, 25 Jun 2017 15:57:35 +0000</pubDate><guid>https://blog.tyage.net/archive/p990.html</guid><description>Overview Problem page:
https://sanitizer.web.ctfcompetition.com
Copy of source code:
https://gist.github.com/tyage/6eabacf6001bd068287842b1052132e4
The application sanitize input and render it.
Sanitizing method The method of sanitizing is follow:
1. Remove the words that match with /meta|srcdoc|utf-16be/i from input.
2. Register a ServiceWorker then, render input in iframe
3. In iframe, it load &amp;lt;script src=sanitize&amp;gt; which executes the following code:
onload = _=&amp;gt; setTimeout&amp;#40;_=&amp;gt; parent.postMessage&amp;#40;document.body.innerHTML, location.origin&amp;#41;, 1000&amp;#41;; remove = node =&amp;gt; &amp;#40;node == document&amp;#41; ? document.</description></item><item><title>31C3 CTF â€“ Page Builder writeup</title><link>https://blog.tyage.net/archive/p829.html</link><pubDate>Fri, 02 Jan 2015 00:32:50 +0000</pubDate><guid>https://blog.tyage.net/archive/p829.html</guid><description>This challenge needs only XSS but it is interesting to me ğŸ™‚
These guys have ripped off our designs and using them in their web pages builder! Weâ€™d Haxx them, donâ€™t worry weâ€™ll give you decent points for it. http://188.40.18.76/ By using the form, we could generate a page.(such as http://188.40.18.76/output/19c94d778563b117e18e3442e887989aea14277d/filename)
It htmlspecialchars the &amp;#8220;title&amp;#8221; and &amp;#8220;file content&amp;#8221; but not &amp;#8220;style&amp;#8221; or &amp;#8220;filename&amp;#8221;.
The maximum size of &amp;#8220;style&amp;#8221; is 8bytes and that of &amp;#8220;filename&amp;#8221; is 65bytes.</description></item><item><title>DEF CON CTF 2014</title><link>https://blog.tyage.net/archive/p802.html</link><pubDate>Tue, 12 Aug 2014 15:29:24 +0000</pubDate><guid>https://blog.tyage.net/archive/p802.html</guid><description>ãƒãƒ¼ãƒ binjaã®ãƒ‘ãƒ¼ã‚«ãƒ¼é‹æ¬ä¿‚ã¨ã—ã¦å‚åŠ ã—ã¦ã„ã¾ã—ãŸ</description></item><item><title>DEF CON CTF Qualifier 2013</title><link>https://blog.tyage.net/archive/p730.html</link><pubDate>Sat, 05 Oct 2013 16:02:42 +0000</pubDate><guid>https://blog.tyage.net/archive/p730.html</guid><description>å•é¡Œè§£ã„ã¦ãŸæ™‚ã®ãƒ­ã‚°ãŒæ®‹ã£ã¦ãªã„ã—ã€æ¢ã›ã°ä»–ãŒå‡ºã¦ãã‚‹ã¨æ€ã†ã®ã§writeupã¯æ›¸ãã¾ã›ã‚“ã€‚
ä¸€å¿œã€webã‚’ä½•å•ã‹ã¨programming2å•ã»ã©ã‚’è§£ãã¾ã—ãŸã€‚
ã†ã¡ã‚’å«ã‚å¤šãã®ãƒãƒ¼ãƒ ãŒwebå•é¡Œã‚’å…¨å®Œã—ã¦ãŠã‚Šã€ä»Šå›ã®webå•é¡Œã¯æ˜“ã—ã‹ã£ãŸã‚ˆã†ã«æ„Ÿã˜ã¾ã™ã€‚
é–‹å§‹ç›´å¾Œã¯ã€8-puzzleã®programmingã‚’è§£ã„ã¦7ä½ãã‚‰ã„ã ã£ãŸã‘ã©ã€æœ€çµ‚çš„ã«ã¯79ä½ã¨ãªã£ãŸã€‚
2æ—¥ç›®ãƒ»3æ—¥ç›®ã¯å­¦æ ¡ã‚’ã‚µãƒœã£ã¦ç˜é«˜ã«ã„ã¦ã€ãƒãƒ¼ãƒ ã§å•é¡Œã‚’è§£ã„ã¦ãŸã‚‰ã ã‚“ã ã‚“æ­£æ°—ãŒä¿ã¦ãªããªã£ã¦ããŸã€‚
ã€ŒçœŸã®ä¼šç¤¾ï¼ˆDEFCONï¼‰ã€ã¨ã€Œä»Šå‹¤ã‚ã¦ã‚‹ä¼šç¤¾ã€ã©ã£ã¡å„ªå…ˆã•ã›ã‚‹ã‹ã¨ã¦ã‚‚æ‚©ã¾ã—ã„
&amp;mdash; ãƒƒã´ã‚‡ã„˜ã‚ƒ (@tyage) June 16, 2013
ãšãƒ¼ã£ã¨PCã«è¨ˆç®—ã•ã›ã¦ã‚‹é–“æ­Œã£ã¦ã‚‹ã€€http://t.co/LvCgHDutg7
&amp;mdash; ãƒƒã´ã‚‡ã„˜ã‚ƒ (@tyage) June 16, 2013
HEYYEYAAEYAAAEYAEYAAãŒæ„è­˜é ããªã£ã¦ã‚‚é ­ã®ä¸­ã‹ã‚‰èã“ãˆã‚‹ã‚ˆã†ã«ãªã£ã¦ããŸ
&amp;mdash; ãƒƒã´ã‚‡ã„˜ã‚ƒ (@tyage) June 16, 2013
DEFCONãŒåƒ•é”ã«æ®‹ã—ãŸã‚‚ã®</description></item><item><title>UFO CTF 2013 writeup â€“ Web200</title><link>https://blog.tyage.net/archive/p719.html</link><pubDate>Sat, 05 Oct 2013 14:55:08 +0000</pubDate><guid>https://blog.tyage.net/archive/p719.html</guid><description>Those aliens consider themselves as the most smart creatures in the world. Pff. They shouldn't even have tried to defeat mankind having such stupid stuff in their heads! As for you, why wouldn't you hack them? They'll most likely surrender then. By the way, it is known that they update some data every 10-20 seconds, but unfortunately our equipment can't intercept the data itself. http://superhosting.tasks.ufoctf.ru:8000/ è‡ªåˆ†ã®ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ãŒä½œã‚Œã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨å¾©å…ƒãŒã§ãã‚‹ã‚·ã‚¹ãƒ†ãƒ ã«ãªã£ã¦ã„ã‚‹ã€‚
ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã¦ã¿ã‚‹ã¨ã€[username]_[md5(username)][md5(zipfile)].zipã¨ã„ã†åå‰ã§zipãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã€ãã‚Œã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ã§å¾©å…ƒãŒã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã€‚
zipãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ã‚’è§£å‡ã™ã‚‹ã¨ã€.backupã¨ã„ã†åå‰ã§ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ•ã‚¡ã‚¤ãƒ«ãŒå…¥ã£ã¦ã„ã‚‹ã€‚
&amp;lt;?xml version=&amp;quot;1.</description></item><item><title>DIMVA CTF 2013 writeup</title><link>https://blog.tyage.net/archive/p697.html</link><pubDate>Fri, 19 Jul 2013 16:29:48 +0000</pubDate><guid>https://blog.tyage.net/archive/p697.html</guid><description>DIMVA CTFã«å‚åŠ ã—ã¦ã„ãŸã€‚
ç§ã®ãƒãƒ¼ãƒ ï¼ˆEpsilon Deltaï¼‰ã¯850ãƒã‚¤ãƒ³ãƒˆã§17ä½ã ã£ãŸã€‚
Web 100 ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ€ãƒ¼ãŒç”¨æ„ã•ã‚Œã¦ãŠã‚Šã€ã©ã†ã«ã‹ã“ã†ã«ã‹ã™ã‚‹å•é¡Œã€‚
ã¯ã˜ã‚ã«ã„ãã¤ã‹ç”»åƒãŒç”¨æ„ã•ã‚Œã¦ãŠã‚Šã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ãªã„ã¨é–²è¦§ã§ããªã„ç”»åƒãŒã‚ã£ãŸãŸã‚ã€ãã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æ±‚ã‚ã‚‹å•é¡Œã¨æ¨å¯Ÿã•ã‚Œã‚‹ã€‚
å„ç”»åƒã«ã¯ã‚¿ã‚°ãŒã¤ã„ã¦ãŠã‚Šã€åŒã˜ã‚¿ã‚°ã‚’æŒã¤å†™çœŸã‚’ä¸€è¦§ã§è¦‹ã‚Œã‚‹ã€‚
ã—ã‹ã—ã€ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚ªãƒ¼ãƒˆã®å…¥ã£ãŸã‚¿ã‚°ã®å ´åˆã¯ä¸€è¦§ãƒšãƒ¼ã‚¸ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ãŸãŸã‚ã€SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ãŒã‚ã‚‹ã¨ã‚ã‹ã£ãŸã€‚
ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸéš›ã€ç”»åƒã®ã‚³ãƒ¡ãƒ³ãƒˆãŒã‚¿ã‚°ã«ãªã£ã¦ç™»éŒ²ã•ã‚Œã‚‹ã®ã§ã€ãã“ã«SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚’åŸ‹ã‚è¾¼ã‚€ã€‚
' union all select password from pictures-- ãã®å¾Œã€ä¸€è¦§ãƒšãƒ¼ã‚¸ã‚’é–²è¦§ã™ã‚‹ã“ã¨ã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå…¥æ‰‹ã§ãã€c0ffeeã‹ã‚‰ã¯ã˜ã¾ã‚‹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒFlagã§ã‚ã‚‹ã¨åˆ¤æ˜ã—ãŸã€‚
c0ffee29e34ad42d38cbe236913c911a ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä»˜ãã®ç”»åƒã¯ã“ã‚“ãªæ„Ÿã˜ã ã£ãŸã€‚
ç´ ç›´ã§ã‚ã‹ã‚Šã‚„ã™ã„å•é¡Œã ã£ãŸã‚ˆã†ã«æ€ã†ã€‚
Web 200 æ™®é€šã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨
10 'user' and/or 'password' parameters missing, please provide an xml parameter of the following form to login: &amp;lt;login&amp;gt;&amp;lt;user&amp;gt;(base64-encoded username)&amp;lt;/user&amp;gt;&amp;lt;password&amp;gt;(base64-encoded password)&amp;lt;/password&amp;gt;&amp;lt;/login&amp;gt; ã£ã¦ã®ãŒè¿”ã£ã¦æ¥ã‚‹ã€‚
ä¸€æ—¥è¿‘ãã€urlã«ãƒ­ã‚°ã‚¤ãƒ³ç”¨xmlã‚’è¶³ã—ãŸã‚Šã€ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦é€ä¿¡ã—ãŸã‚Šã€é€ä¿¡ã™ã‚‹ãƒ‘ã‚±ãƒƒãƒˆã®ã„ã‚ã‚“ãªã¨ã“ã‚ã«åŸ‹ã‚è¾¼ã‚“ã ã‚Šã—ã¦æ‚©ã‚“ã ã€‚ã€‚ã€‚
ã‚³ãƒ³ãƒ†ã‚¹ãƒˆçµ‚äº†ç›´å‰ã«ãªã£ã¦ã€/?xml=&amp;#8230;ã¨ã™ã‚Œã°ãƒ­ã‚°ã‚¤ãƒ³ã§ãã‚‹ã“ã¨ã«æ°—ã¥ãã€‚
xml parameterã£ã¦ã®ãŒç´ ç›´ã«xmlã£ã¦åå‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã ã£ãŸã®ã«ã€ãã“ã«æ°—ã¥ãã¾ã§ã«ä¸€æ—¥ã‹ã‹ã£ã¦è‹±èªã®å£ã‚’æ„Ÿã˜ã‚‹ã€‚
ã“ã‚ŒãŒã‚ã‹ã‚Œã°ã‚ã¨ã¯è§£ãã ã‘ã€‚
ã¨ã‚Šã‚ãˆãšè‰²ã€…è©¦ã—ã¦ã„ã‚‹ã¨ã€ä»¥ä¸‹ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¿”ã£ã¦æ¥ãŸãŸã‚ã€XPathã¸ã®ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã ã¨ã‚ã‹ã£ãŸã€‚
Error during login: Query: //User[UserName/text()='' and Password/text()='' '... ........................................................^^^ Invalid query somewhere around here (I think) ã€Œ&amp;#8217; or &amp;#8216;1&amp;#8217;=&amp;#8217;1ã€ã¨ã‹ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã«æˆåŠŸã™ã‚‹ã¨ã€htmlã®ã‚³ãƒ¡ãƒ³ãƒˆã§ã€Œusers.</description></item><item><title>SIGINT CTF 2013 writeup â€“ bloat (cloud 200)</title><link>https://blog.tyage.net/archive/p689.html</link><pubDate>Tue, 16 Jul 2013 20:23:45 +0000</pubDate><guid>https://blog.tyage.net/archive/p689.html</guid><description>&lt;h3>CTF&lt;/h3>
&lt;p>ãˆã¨ã€ãƒ–ãƒ­ã‚°ã‚’æ›´æ–°åœæ­¢ã—ã¦ã„ã‚‹é–“ã«ã€Epsilon Deltaã¨ã—ã¦ã„ãã¤ã‹CTFã«å‚åŠ ã—ã¦ã„ã¾ã—ãŸã€‚&lt;/p>
&lt;ul>
&lt;li>Codegate YUT Preliminary 2013&lt;/li>
&lt;li>Nuit du Hack CTF Quals 2013&lt;/li>
&lt;li>BaltCTF Quals 2013&lt;/li>
&lt;li>SECUINSIDE CTF Quals 2013&lt;/li>
&lt;li>Boston Key Party CTF 2013&lt;/li>
&lt;li>DEF CON CTF Qualifier 2013&lt;/li>
&lt;li>SIGINT CTF 2013&lt;/li>
&lt;/ul>
&lt;p>ã¯ã˜ã‚ã¯æµ·å¤–ã®CTFã®æ„Ÿè¦šãŒã¤ã‹ã‚ãšã€ã¡ã‚ƒã‚“ã¨è§£ã„ãŸã‚ˆã†ãªè¨˜æ†¶ã‚‚ãªã‹ã£ãŸã®ã§ã™ãŒã€BKPã‚ãŸã‚Šã‹ã‚‰ã¯å°‘ã—æ…£ã‚Œã¦ããŸã‚ˆã†ãªæ°—ãŒã—ã¾ã™ã€‚&lt;/p>
&lt;p>ä»Šã¾ã§è§£ã„ã¦ãŸå•é¡Œã®write upã‚’æ›¸ã“ã†ã¨ã‚‚æ€ã£ãŸã®ã§ã™ãŒã€ã™ã£ã‹ã‚Šå¿˜ã‚Œã¦ã—ã¾ã£ã¦ã„ã‚‹ãŸã‚ã€ä¸€ç•ªæœ€è¿‘ã‚„ã£ãŸSIGINT CTFã®write upã‚’æ›¸ãã“ã¨ã«ã—ã¾ã™ã€‚&lt;/p>
&lt;p></description></item></channel></rss>