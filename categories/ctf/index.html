<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>CTF</title><meta name=description content="Talk about daily things"><meta name=keywords content><meta property="og:url" content="https://blog.tyage.net/categories/ctf/"><meta property="og:type" content="website"><meta property="og:title" content="CTF"><meta property="og:description" content="Talk about daily things"><meta property="og:image" content="https://blog.tyage.net/icon/icon.jpg"><meta property="og:image:secure_url" content="https://blog.tyage.net/icon/icon.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="CTF"><meta name=twitter:description content="Talk about daily things"><meta property="twitter:domain" content="https://blog.tyage.net/categories/ctf/"><meta property="twitter:url" content="https://blog.tyage.net/categories/ctf/"><meta name=twitter:image content="https://blog.tyage.net/icon/icon.jpg"><link rel=canonical href=https://blog.tyage.net/categories/ctf/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.edd985581bf860dfb4507e5885197f1680160c7fe19f23b31e183126d99dd596.js integrity="sha256-7dmFWBv4YN+0UH5YhRl/FoAWDH/hnyOzHhgxJtmd1ZY="></script>
<script src=/redirect.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-C64TPJYY96"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-C64TPJYY96")</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1507795450221855" crossorigin=anonymous></script></head><body><script type=text/javascript>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://blog.tyage.net><img src=https://blog.tyage.net/icon/icon.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://blog.tyage.net>blog.tyage.net</a></div><div class=nav-links><div class=nav-link><a href=https://blog.tyage.net/post><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://blog.tyage.net/index.xml><span data-feather=rss></span> RSS</a></div><div class=nav-link><a href=https://tyage.net><span data-feather=home></span> About me</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only></span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span id=hamburger-menu-toggle-screen-reader-target class=sr-only>menu</span>
<a><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://blog.tyage.net/post><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://blog.tyage.net/index.xml><span data-feather=rss></span> RSS</a></li><li class=nav-item><a href=https://tyage.net><span data-feather=home></span> About me</a></li><li class="nav-item dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only>theme</span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="container list-posts"><h1 class=list-title>CTF</h1><h2 class=posts-year>2018</h2><article class="post-title h-entry"><a href=https://blog.tyage.net/archive/p1187.html class="post-link u-bridgy-fed p-name">CSP Embedded EnforcementでXSS mitigationをbypassする話</a><div class=flex-break></div><span class=post-date>June 26, 2018</span><div class=e-content style=display:none><h2>なに</h2><p>CSP Embedded Enforcementを使って、JavaScriptで書かれたXSS mitigationをbypassできるパターンがあるという話。<br>以下のような条件が必要なので現実に使える場面は普通はなさそう。<br>CTFでは便利かもしれない。</p><ul><li>Webページで同一オリジンのページをiframeで読み込める</li><li>WebページのヘッダにCSPが設定されていない</li><li>Webページに指定したHTMLを埋め込める(XSSができる)</li><li>ただし、WebページにJavaScriptによるXSS防御機構がある</li></ul><p>このとき、CSP Embedded Enforcementを使うことで、防御機構を回避して攻撃コードだけを実行することができる。</p></div></article><article class="post-title h-entry"><a href=https://blog.tyage.net/archive/p1138.html class="post-link u-bridgy-fed p-name">SECCON 2017 Final International competition – 参 writeup</a><div class=flex-break></div><span class=post-date>March 22, 2018</span><div class=e-content style=display:none>SECCON 2017国際決勝に参加した。
5種類のKoH形式の問題と、いくつかのJeopardy形式の問題が出題された。
問題参(KoH)の問題文:
The Raspberry Pi distributed to each team contains the Bingo-Service program
Please log-in your Raspberry Pi ( ssh: 192.168.4.254, user/pass = pi/kenjiinwonderland )
Please set up Bingo-Service on 192.168.4.254 : 80
If you click &#8220;Measure&#8221; button above, the system will accesses your Bingo-Service in a few minutes later
&#8220;Measure&#8221; button can be clicked once every 7 minutes (Once you click it, you have to wait for 7 minutes)</div></article><h2 class=posts-year>2017</h2><article class="post-title h-entry"><a href=https://blog.tyage.net/archive/p1043.html class="post-link u-bridgy-fed p-name">Tokyo Westerns CTF 2017 – Clock Style Sheet writeup</a><div class=flex-break></div><span class=post-date>September 5, 2017</span><div class=e-content style=display:none>Overview Problem page:
http://css.chal.ctf.westerns.tokyo/
Provided source code:
proxy.py
sanitizer.py
There are 4 pages: /, /refresh, /chrowler, /flag.
When we access /flag, it responses only local IP is allowed. (your IP: 110.3.193.114).
So, we should use /chrowler (crawler using Chrome) to get the content in /flag.
Find XSS Next, we search XSS and found /refresh has it. (We found the vulnerability when browsing with w3m)
In this page, user will be redirected to the page where he or she is (which represented by Referer header).</div></article><article class="post-title h-entry"><a href=https://blog.tyage.net/archive/p1020.html class="post-link u-bridgy-fed p-name">Google CTF 2017 – Geokitties v2 writeup</a><div class=flex-break></div><span class=post-date>June 25, 2017</span><div class=e-content style=display:none>Overview Problem page:
https://geokittiesv2.web.ctfcompetition.com/
Copy of source code:
https://gist.github.com/tyage/cac08c8e17b90b840fb22cb434cff127
It receives comment, then admin checks it and clicks a link.
The comment is validated by using htmlparser2.
Allowed tags are: p, a, b, img, br, i
Invalid attributes: on(.*)= and href=javascript:...
Solution What we should do is find the differences in parsing between Google Chrome and htmlparser2.
After some time, I realize that when input is utf-16 string, Chrome parses it as utf-16 string but htmlparser2 does not.</div></article><article class="post-title h-entry"><a href=https://blog.tyage.net/archive/p990.html class="post-link u-bridgy-fed p-name">Google CTF 2017 – The X Sanitizer writeup</a><div class=flex-break></div><span class=post-date>June 25, 2017</span><div class=e-content style=display:none>Overview Problem page:
https://sanitizer.web.ctfcompetition.com
Copy of source code:
https://gist.github.com/tyage/6eabacf6001bd068287842b1052132e4
The application sanitize input and render it.
Sanitizing method The method of sanitizing is follow:
1. Remove the words that match with /meta|srcdoc|utf-16be/i from input.
2. Register a ServiceWorker then, render input in iframe
3. In iframe, it load &lt;script src=sanitize> which executes the following code:
onload = _=> setTimeout(_=> parent.postMessage(document.body.innerHTML, location.origin), 1000); remove = node => (node == document) ? document.</div></article><h2 class=posts-year>2015</h2><article class="post-title h-entry"><a href=https://blog.tyage.net/archive/p829.html class="post-link u-bridgy-fed p-name">31C3 CTF – Page Builder writeup</a><div class=flex-break></div><span class=post-date>January 2, 2015</span><div class=e-content style=display:none>This challenge needs only XSS but it is interesting to me 🙂
These guys have ripped off our designs and using them in their web pages builder! We’d Haxx them, don’t worry we’ll give you decent points for it. http://188.40.18.76/ By using the form, we could generate a page.(such as http://188.40.18.76/output/19c94d778563b117e18e3442e887989aea14277d/filename)
It htmlspecialchars the &#8220;title&#8221; and &#8220;file content&#8221; but not &#8220;style&#8221; or &#8220;filename&#8221;.
The maximum size of &#8220;style&#8221; is 8bytes and that of &#8220;filename&#8221; is 65bytes.</div></article><h2 class=posts-year>2014</h2><article class="post-title h-entry"><a href=https://blog.tyage.net/archive/p802.html class="post-link u-bridgy-fed p-name">DEF CON CTF 2014</a><div class=flex-break></div><span class=post-date>August 12, 2014</span><div class=e-content style=display:none>チームbinjaのパーカー運搬係として参加していました</div></article><h2 class=posts-year>2013</h2><article class="post-title h-entry"><a href=https://blog.tyage.net/archive/p730.html class="post-link u-bridgy-fed p-name">DEF CON CTF Qualifier 2013</a><div class=flex-break></div><span class=post-date>October 5, 2013</span><div class=e-content style=display:none>問題解いてた時のログが残ってないし、探せば他が出てくると思うのでwriteupは書きません。
一応、webを何問かとprogramming2問ほどを解きました。
うちを含め多くのチームがweb問題を全完しており、今回のweb問題は易しかったように感じます。
開始直後は、8-puzzleのprogrammingを解いて7位くらいだったけど、最終的には79位となった。
2日目・3日目は学校をサボって灘高にいて、チームで問題を解いてたらだんだん正気が保てなくなってきた。
「真の会社（DEFCON）」と「今勤めてる会社」どっち優先させるかとても悩ましい
&mdash; ッぴょㄘゃ (@tyage) June 16, 2013
ずーっとPCに計算させてる間歌ってる　http://t.co/LvCgHDutg7
&mdash; ッぴょㄘゃ (@tyage) June 16, 2013
HEYYEYAAEYAAAEYAEYAAが意識遠くなっても頭の中から聞こえるようになってきた
&mdash; ッぴょㄘゃ (@tyage) June 16, 2013
DEFCONが僕達に残したもの</div></article><article class="post-title h-entry"><a href=https://blog.tyage.net/archive/p719.html class="post-link u-bridgy-fed p-name">UFO CTF 2013 writeup – Web200</a><div class=flex-break></div><span class=post-date>October 5, 2013</span><div class=e-content style=display:none>Those aliens consider themselves as the most smart creatures in the world. Pff. They shouldn't even have tried to defeat mankind having such stupid stuff in their heads! As for you, why wouldn't you hack them? They'll most likely surrender then. By the way, it is known that they update some data every 10-20 seconds, but unfortunately our equipment can't intercept the data itself. http://superhosting.tasks.ufoctf.ru:8000/ 自分のウェブページが作れ、バックアップと復元ができるシステムになっている。
バックアップしてみると、[username]_[md5(username)][md5(zipfile)].zipという名前でzipファイルがダウンロードでき、それをアップロードすることで復元ができるようになっている。
zipファイルの中身を解凍すると、.backupという名前で以下のようなファイルが入っている。
&lt;?xml version="1.</div></article><article class="post-title h-entry"><a href=https://blog.tyage.net/archive/p697.html class="post-link u-bridgy-fed p-name">DIMVA CTF 2013 writeup</a><div class=flex-break></div><span class=post-date>July 19, 2013</span><div class=e-content style=display:none>DIMVA CTFに参加していた。
私のチーム（Epsilon Delta）は850ポイントで17位だった。
Web 100 画像アップローダーが用意されており、どうにかこうにかする問題。
はじめにいくつか画像が用意されており、パスワードを入力しないと閲覧できない画像があったため、そのパスワードを求める問題と推察される。
各画像にはタグがついており、同じタグを持つ写真を一覧で見れる。
しかし、シングルクオートの入ったタグの場合は一覧ページでエラーが発生していたため、SQLインジェクションがあるとわかった。
画像をアップロードした際、画像のコメントがタグになって登録されるので、そこにSQLインジェクションを埋め込む。
' union all select password from pictures-- その後、一覧ページを閲覧することでパスワードが入手でき、c0ffeeからはじまるパスワードがFlagであると判明した。
c0ffee29e34ad42d38cbe236913c911a パスワード付きの画像はこんな感じだった。
素直でわかりやすい問題だったように思う。
Web 200 普通にアクセスすると
10 'user' and/or 'password' parameters missing, please provide an xml parameter of the following form to login: &lt;login>&lt;user>(base64-encoded username)&lt;/user>&lt;password>(base64-encoded password)&lt;/password>&lt;/login> ってのが返って来る。
一日近く、urlにログイン用xmlを足したり、ファイルとして送信したり、送信するパケットのいろんなところに埋め込んだりして悩んだ。。。
コンテスト終了直前になって、/?xml=&#8230;とすればログインできることに気づく。
xml parameterってのが素直にxmlって名前のリクエストパラメータだったのに、そこに気づくまでに一日かかって英語の壁を感じる。
これがわかればあとは解くだけ。
とりあえず色々試していると、以下のレスポンスが返って来たため、XPathへのインジェクションだとわかった。
Error during login: Query: //User[UserName/text()='' and Password/text()='' '... ........................................................^^^ Invalid query somewhere around here (I think) 「&#8217; or &#8216;1&#8217;=&#8217;1」とかしてログインに成功すると、htmlのコメントで「users.</div></article><article class="post-title h-entry"><a href=https://blog.tyage.net/archive/p689.html class="post-link u-bridgy-fed p-name">SIGINT CTF 2013 writeup – bloat (cloud 200)</a><div class=flex-break></div><span class=post-date>July 16, 2013</span><div class=e-content style=display:none><h3>CTF</h3><p>えと、ブログを更新停止している間に、Epsilon DeltaとしていくつかCTFに参加していました。</p><ul><li>Codegate YUT Preliminary 2013</li><li>Nuit du Hack CTF Quals 2013</li><li>BaltCTF Quals 2013</li><li>SECUINSIDE CTF Quals 2013</li><li>Boston Key Party CTF 2013</li><li>DEF CON CTF Qualifier 2013</li><li>SIGINT CTF 2013</li></ul><p>はじめは海外のCTFの感覚がつかめず、ちゃんと解いたような記憶もなかったのですが、BKPあたりからは少し慣れてきたような気がします。</p><p>今まで解いてた問題のwrite upを書こうとも思ったのですが、すっかり忘れてしまっているため、一番最近やったSIGINT CTFのwrite upを書くことにします。</p><p></div></article></div></main><footer class=footer><span>&copy; <a href=https://tyage.net/ class=h-card rel=me>tyage</a></span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/526avijitgupta/gokarna>Gokarna</a></span></footer></body></html>